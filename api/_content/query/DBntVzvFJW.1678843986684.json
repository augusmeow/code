{"_path":"/cpp/concept/atomic","_dir":"concept","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"原子","description":"atomic 是一个 C++ 关键字，它表示一个原子操作，即一个不可被线程安全地拆分的操作。原子操作通常用于多线程环境下，可以保证在执行过程中不会被其他线程干扰。","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"原子"},"children":[{"type":"text","value":"原子"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"atomic 是一个 C++ 关键字，它表示一个原子操作，即一个不可被线程安全地拆分的操作。原子操作通常用于多线程环境下，可以保证在执行过程中不会被其他线程干扰。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"C++ 的 atomic 类型提供了一种简单的方法来执行原子操作，它可以保证在多线程环境下，一个原子操作的执行是完整的，不会被线程安全地拆分。atomic 类型提供了一些基本的操作，包括原子加法、原子减法、原子比较、原子交换等。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"下面是一个简单的 atomic 类型的使用示例："}]},{"type":"element","tag":"code","props":{"code":"#include <atomic>\n#include <iostream>\n\nint main() {\n  std::atomic<int> a(0);\n  std::cout << \"a = \" << a << std::endl; // 输出 a 的值\n\n  a++; // 原子加法\n  std::cout << \"a = \" << a << std::endl; // 输出 a 的值\n\n  a--; // 原子减法\n  std::cout << \"a = \" << a << std::endl; // 输出 a 的值\n\n  int b = 1;\n  a.compare_exchange_strong(b, 2); // 原子比较并交换\n  std::cout << \"a = \" << a << std::endl; // 输出 a 的值\n  return 0;\n}\n","language":"cpp","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"#include"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d666cb"},"children":[{"type":"text","value":"<atomic>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"#include"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d666cb"},"children":[{"type":"text","value":"<iostream>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cf9ac1"},"children":[{"type":"text","value":"main"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"() {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-e77a1d"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"::atomic"}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"<int>"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cf9ac1"},"children":[{"type":"text","value":"a"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-88c9ab"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-e77a1d"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"::cout "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d666cb"},"children":[{"type":"text","value":"\"a = \""}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" a "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e77a1d"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"::endl;"}]},{"type":"element","tag":"span","props":{"class":"ct-e9afdd"},"children":[{"type":"text","value":" // 输出 a 的值"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"  a"}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"++"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":";"}]},{"type":"element","tag":"span","props":{"class":"ct-e9afdd"},"children":[{"type":"text","value":" // 原子加法"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-e77a1d"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"::cout "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d666cb"},"children":[{"type":"text","value":"\"a = \""}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" a "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e77a1d"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"::endl;"}]},{"type":"element","tag":"span","props":{"class":"ct-e9afdd"},"children":[{"type":"text","value":" // 输出 a 的值"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"  a"}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"--"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":";"}]},{"type":"element","tag":"span","props":{"class":"ct-e9afdd"},"children":[{"type":"text","value":" // 原子减法"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-e77a1d"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"::cout "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d666cb"},"children":[{"type":"text","value":"\"a = \""}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" a "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e77a1d"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"::endl;"}]},{"type":"element","tag":"span","props":{"class":"ct-e9afdd"},"children":[{"type":"text","value":" // 输出 a 的值"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" b "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-88c9ab"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"  a."}]},{"type":"element","tag":"span","props":{"class":"ct-cf9ac1"},"children":[{"type":"text","value":"compare_exchange_strong"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"(b, "}]},{"type":"element","tag":"span","props":{"class":"ct-88c9ab"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":");"}]},{"type":"element","tag":"span","props":{"class":"ct-e9afdd"},"children":[{"type":"text","value":" // 原子比较并交换"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-e77a1d"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"::cout "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-d666cb"},"children":[{"type":"text","value":"\"a = \""}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" a "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e77a1d"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"::endl;"}]},{"type":"element","tag":"span","props":{"class":"ct-e9afdd"},"children":[{"type":"text","value":" // 输出 a 的值"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-e0177d"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-88c9ab"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-90bf3b"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"上面的程序定义了一个 atomic 类型的变量 a，并使用原子加法、原子减法、原子比较并交换等操作来修改 a 的值。通过使用 atomic 类型，我们可以确保在多线程环境下，这些操作的执行是完整的，不会被其他线程打断。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"通常情况下，atomic 类型的变量可以和普通类型的变量一样使用，只不过在多线程环境下，它们可以保证操作的完整性。因此，如果你的程序需要在多线程环境下执行原子操作，那么你可以使用 atomic 类型来保证操作的正确性。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"另外，atomic 类型还支持一些高级的操作，比如原子访问、原子指针、原子引用等。这些操作可以让你在多线程环境下，安全地访问、操作、交换指针和引用类型的变量。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"总之，atomic 是 C++ 中一个非常重要的关键字，它可以保证在多线程环境下，原子操作的完整性。如果你的程序需要在多线程环境下执行原子操作，那么你可以使用 atomic 类型来保证操作的正确性。"}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-e9afdd{color:#6E7781}\n.ct-88c9ab{color:#0550AE}\n.ct-e77a1d{color:#953800}\n.ct-cf9ac1{color:#8250DF}\n.ct-d666cb{color:#0A3069}\n.ct-90bf3b{color:#24292F}\n.ct-e0177d{color:#CF222E}\n.dark .ct-e0177d{color:#FF7B72}\n.dark .ct-90bf3b{color:#C9D1D9}\n.dark .ct-d666cb{color:#A5D6FF}\n.dark .ct-cf9ac1{color:#D2A8FF}\n.dark .ct-e77a1d{color:#FFA657}\n.dark .ct-88c9ab{color:#79C0FF}\n.dark .ct-e9afdd{color:#8B949E}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:1.cpp:concept:atomic.md","_source":"content","_file":"1.cpp/concept/atomic.md","_extension":"md"}