{"_path":"/notes/docker","_dir":"notes","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Docker","description":"","icon":"logos:docker-icon","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"docker"},"children":[{"type":"text","value":"Docker"}]},{"type":"element","tag":"h2","props":{"id":"install"},"children":[{"type":"text","value":"install"}]},{"type":"element","tag":"h3","props":{"id":"ubuntu"},"children":[{"type":"element","tag":"a","props":{"href":"https://docs.docker.com/engine/install/ubuntu/#prerequisites","rel":["nofollow"]},"children":[{"type":"text","value":"ubuntu"}]}]},{"type":"element","tag":"code","props":{"code":"sudo mkdir -p /etc/apt/keyrings\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg\necho \\\n  \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \\\n  $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null\nsudo apt-get update\nsudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin\nsudo docker run hello-world\n","language":"shell","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"mkdir"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-p"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"/etc/apt/keyrings"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-fsSL"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"https://download.docker.com/linux/ubuntu/gpg"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"|"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"gpg"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"--dearmor"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-o"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"/etc/apt/keyrings/docker.gpg"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"\\"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"\"deb [arch=$("}]},{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"dpkg"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"--print-architecture"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":") signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"\\"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"  $("}]},{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"lsb_release"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-cs"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":") stable\""}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"|"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"tee"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"/etc/apt/sources.list.d/docker.list"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":">"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"/dev/null"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"apt-get"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"update"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"apt-get"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"install"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"docker-ce"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"docker-ce-cli"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"containerd.io"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"docker-compose-plugin"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"run"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"hello-world"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"debian"},"children":[{"type":"text","value":"debian"}]},{"type":"element","tag":"code","props":{"code":"sudo mkdir -p /etc/apt/keyrings\ncurl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg\necho \\\n  \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian \\\n  $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null\nsudo apt-get update  \nsudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin\n","language":"shell","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"mkdir"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-p"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"/etc/apt/keyrings"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-fsSL"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"https://download.docker.com/linux/debian/gpg"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"|"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"gpg"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"--dearmor"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-o"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"/etc/apt/keyrings/docker.gpg"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"\\"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"\"deb [arch=$("}]},{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"dpkg"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"--print-architecture"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":") signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"\\"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"  $("}]},{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"lsb_release"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-cs"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":") stable\""}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"|"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"tee"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"/etc/apt/sources.list.d/docker.list"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":">"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"/dev/null"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"apt-get"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"update"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":"  "}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"apt-get"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"install"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"docker-ce"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"docker-ce-cli"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"containerd.io"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"docker-compose-plugin"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"build"},"children":[{"type":"text","value":"build"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"当你使用 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"docker build"}]},{"type":"text","value":" 命令构建镜像时，镜像会被保存在你本地电脑上的 Docker 镜像仓库中。通常，这个仓库位于 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/var/lib/docker"}]},{"type":"text","value":" 目录中。要查看镜像仓库中所有的镜像，可以使用 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"docker images"}]},{"type":"text","value":" 命令。如果你想要查看镜像的详细信息，可以使用 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"docker inspect"}]},{"type":"text","value":" 命令。"}]},{"type":"element","tag":"code","props":{"code":"docker image build .\n","language":"shell","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"image"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"build"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"."}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"这样操作的 REPOSITORY TAG 都为 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"<none>"}]},{"type":"text","value":" 使用 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"docker tag"}]}]},{"type":"element","tag":"code","props":{"code":"docker tag <image> <tag>\ndocker tag <your_image name or id> <tag>\ndocker tag my-img my-repo:my-tag\n","language":"shell","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"tag"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"imag"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":"e"}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":">"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"ta"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":"g"}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":">"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"tag"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"your_image"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"or"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"i"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":"d"}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":">"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"ta"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":"g"}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":">"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"tag"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"my-img"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"my-repo:my-tag"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"dockerfile_name 可以在同一项目里放置多个 dockerfile"}]},{"type":"element","tag":"code","props":{"code":"docker build -t my_image -f dockerfile_name .\n","language":"shell","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"build"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-t"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"my_image"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-f"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"dockerfile_name"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"."}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"run"},"children":[{"type":"text","value":"run"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"运行 docker："}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"启动 docker 服务："},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"sudo service docker start"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"进入 docker 终端："},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"docker run -it [image_name] /bin/bash"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在 docker 里运行命令："}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"在 docker 终端中输入命令，按下回车执行。例如："},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"ls"}]},{"type":"text","value":" 查看当前目录文件列表。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"也可以在运行 docker 时指定要执行的命令，例如："},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"docker run [image_name] ls"}]},{"type":"text","value":" 查看当前目录文件列表。"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"退出 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"exit"}]},{"type":"text","value":" / "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Ctrl + D"}]}]},{"type":"element","tag":"h2","props":{"id":"exec"},"children":[{"type":"text","value":"exec"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在运行的容器中执行命令"}]},{"type":"element","tag":"code","props":{"code":"docker exec [OPTIONS] CONTAINER COMMAND [ARG...]\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"exec"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" [OPTIONS] "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"CONTAINER"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"COMMAND"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" [ARG...]"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"OPTIONS说明"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"-d"}]},{"type":"text","value":": 分离模式: 在后台运行"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"-i"}]},{"type":"text","value":": 即使没有附加也保持STDIN 打开"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"-t"}]},{"type":"text","value":": 分配一个伪终端"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"e.g."}]},{"type":"element","tag":"code","props":{"code":"docker exec -it container_id /bin/bash\n","language":"bash","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"exec"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-it"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"container_id"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"/bin/bash"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"save"},"children":[{"type":"text","value":"save"}]},{"type":"element","tag":"code","props":{"code":"# 在 Linux 上将 Docker image my_image 打包为 tar 文件 my_image.tar\ndocker save my_image > my_image.tar\n\n# 将 tar 文件复制到本地\nscp my_image.tar user@localhost:~/\n\n# 将 tar 文件导入到本地的 Docker 中\ndocker load < my_image.tar\n","language":"shell","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"# 在 Linux 上将 Docker image my_image 打包为 tar 文件 my_image.tar"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"save"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"my_image"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":">"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"my_image.tar"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"# 将 tar 文件复制到本地"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"scp"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"my_image.tar"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"user@localhost:~/"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"# 将 tar 文件导入到本地的 Docker 中"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"load"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"my_image.tar"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"multi-stage"},"children":[{"type":"text","value":"multi-stage"}]},{"type":"element","tag":"h3","props":{"id":"参数传递"},"children":[{"type":"text","value":"参数传递"}]},{"type":"element","tag":"list","props":{},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ARG 声明传入的参数"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"FROM 分隔了不同的构建阶段"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"不同构建阶段必须先声明 ARG 后才能使用"}]}]}]},{"type":"element","tag":"code","props":{"code":"ARG COMMIT_ID\nARG APP_VERSION\n\n# stage 1\nFROM augus/basin-env:latest AS stage-compile\n\nARG COMMIT_ID\n\nENV WORK_PATH /augus\n\nWORKDIR ${WORK_PATH}\nRUN ${WORK_PATH}/a.sh ${COMMIT_ID}\n\n\n# stage 2\nFROM debian:latest AS stage-runtime\n\nARG COMMIT_ID\nARG APP_VERSION\n\nENV WORK_PATH /augus\nENV PROJECT_NAME \"AUGUS\"\nENV PROJECT_SYS_TYPE \"Linux_x86_64\"\nENV RELEASE ${PROJECT_NAME}_v${APP_VERSION}_${PROJECT_SYS_TYPE}_${COMMIT_ID}.deb\n\nRUN echo ${RELEASE}\n\nWORKDIR ${WORK_PATH}\nCOPY --from=stage-compile ${WORK_PATH}/${RELEASE} .\n","filename":"e.g.","language":"docker","meta":"[e.g.]"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"ARG"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" COMMIT_ID"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"ARG"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" APP_VERSION"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"# stage 1"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"FROM"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" augus/basin-env:latest "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"AS"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" stage-compile"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"ARG"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" COMMIT_ID"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"ENV"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" WORK_PATH /augus"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"WORKDIR"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" ${WORK_PATH}"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"RUN"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" ${WORK_PATH}/a.sh ${COMMIT_ID}"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"# stage 2"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"FROM"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" debian:latest "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"AS"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" stage-runtime"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"ARG"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" COMMIT_ID"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"ARG"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" APP_VERSION"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"ENV"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" WORK_PATH /augus"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"ENV"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" PROJECT_NAME "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"\"AUGUS\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"ENV"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" PROJECT_SYS_TYPE "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"\"Linux_x86_64\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"ENV"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" RELEASE ${PROJECT_NAME}_v${APP_VERSION}_${PROJECT_SYS_TYPE}_${COMMIT_ID}.deb"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"RUN"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" echo ${RELEASE}"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"WORKDIR"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" ${WORK_PATH}"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"COPY"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" --from=stage-compile ${WORK_PATH}/${RELEASE} ."}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"通过 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"--build-arg KEY=\"VAL\""}]},{"type":"text","value":" 传入参数"}]},{"type":"element","tag":"h3","props":{"id":"指定阶段"},"children":[{"type":"text","value":"指定阶段"}]},{"type":"element","tag":"code","props":{"code":"docker build --target stage-runtime -t augus/test:runtime .\n","language":"shell","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"build"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"--target"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"stage-runtime"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-t"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"augus/test:runtime"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"."}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"阶段内引用"},"children":[{"type":"text","value":"阶段内引用"}]},{"type":"element","tag":"code","props":{"code":"FROM debian:latest AS base\n# ...\nFROM base AS derive\n# ...\nFROM derive AS son\n# ...\n","language":"docker","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"FROM"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" debian:latest "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"AS"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" base"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"# ..."}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"FROM"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" base "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"AS"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" derive"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"# ..."}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"FROM"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" derive "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"AS"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" son"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"# ..."}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"check-docker"},"children":[{"type":"text","value":"check docker"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"初始化判断docker中某镜像是否存在"}]},{"type":"element","tag":"code","props":{"code":"CON=`docker image ls 'augus:latest' | wc -l`\nif [ $CON -eq 2 ]  #CON取值为2表示镜像存在，为1镜像不存在\nthen\ndocker rmi augus  #镜像存在时remove\nfi\n","language":"shell","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":"CON"}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":" image ls 'augus:latest' "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"|"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"wc"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-l"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"`"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" [ $CON "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"-eq"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" ]  "}]},{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"#CON取值为2表示镜像存在，为1镜像不存在"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"then"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"rmi"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"augus "}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"#镜像存在时remove"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"fi"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"cp"},"children":[{"type":"text","value":"cp"}]},{"type":"element","tag":"h3","props":{"id":"dockerfile-内互相拷贝"},"children":[{"type":"text","value":"dockerfile 内互相拷贝"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"参考上面的 e.g."}]},{"type":"element","tag":"h3","props":{"id":"一个docker里的文件迁移到另一个docker"},"children":[{"type":"text","value":"一个docker里的文件迁移到另一个docker"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"要将一个Docker容器中的文件迁移到另一个Docker容器，你需要使用Docker的"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"cp"}]},{"type":"text","value":"命令。首先，使用"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"docker ps"}]},{"type":"text","value":"命令查看正在运行的Docker容器的ID。然后，使用以下命令将文件从源容器复制到目标容器："}]},{"type":"element","tag":"code","props":{"code":"docker cp [source_container_id]:/path/to/source/file [target_container_id]:/path/to/target/file\n","language":"shell","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"cp"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" [source_container_id]:/path/to/source/file [target_container_id]:/path/to/target/file"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"例如，如果要将一个名为"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"myfile.txt"}]},{"type":"text","value":"的文件从源容器"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"4fa6e0f0c67a"}]},{"type":"text","value":"复制到目标容器"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"8dbd9e392a96"}]},{"type":"text","value":"，你可以使用以下命令："}]},{"type":"element","tag":"code","props":{"code":"docker cp 4fa6e0f0c67a:/myfile.txt 8dbd9e392a96:/myfile.txt\n","language":"shell","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"cp"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"4fa6e0f0c67a:/myfile.txt"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"8dbd9e392a96:/myfile.txt"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"请注意，在上面的命令中，"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/path/to/source/file"}]},{"type":"text","value":"和"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/path/to/target/file"}]},{"type":"text","value":"都是相对于Docker容器中的根目录的路径。因此，如果文件在Docker容器中的其他目录下，你需要指定完整的路径。"}]},{"type":"element","tag":"h2","props":{"id":"第一个-docker"},"children":[{"type":"text","value":"第一个 docker"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"要写一个 Dockerfile，需要按照以下步骤进行："}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"打开一个文本编辑器，新建一个文件，并命名为“Dockerfile”（注意文件名的大小写）。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"在文件中输入以下内容："},{"type":"element","tag":"code","props":{"code":"# 指定基础镜像\nFROM <base image>\n# 指定维护人员的名字和电子邮件地址\nMAINTAINER <name> <email>\n# 安装需要的软件包\nRUN <command>\n# 拷贝文件到容器中\nCOPY <src> <dest>\n# 暴露容器中的端口\nEXPOSE <port>\n# 容器启动时运行的命令\nCMD <command>\n","language":"docker","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"# 指定基础镜像"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"FROM"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" <base image>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"# 指定维护人员的名字和电子邮件地址"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"MAINTAINER"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" <name> <email>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"# 安装需要的软件包"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"RUN"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" <command>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"# 拷贝文件到容器中"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"COPY"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" <src> <dest>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"# 暴露容器中的端口"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"EXPOSE"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" <port>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1343a9"},"children":[{"type":"text","value":"# 容器启动时运行的命令"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"CMD"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" <command>"}]}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"根据需要，修改上面各项内容的具体值。例如，如果你想基于 Ubuntu 镜像构建容器，那么 FROM 命令就应该写成：FROM ubuntu。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"保存文件，并在命令行中运行以下命令来构建镜像："},{"type":"element","tag":"code","props":{"code":"docker build -t <image name> .\n","language":"shell","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"build"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-t"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"image"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"nam"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":"e"}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":">"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"."}]}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"构建完成后，就可以使用以下命令来运行容器："},{"type":"element","tag":"code","props":{"code":"docker run -d -p <host port>:<container port> <image name>\n","language":"shell","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"run"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-d"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-cd20f1"},"children":[{"type":"text","value":"-p"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"host"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"por"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":"t"}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":">"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"container"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"por"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":"t"}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":">"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"image"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"nam"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":"e"}]},{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":">"}]}]}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"　　\n这样就完成了一个 Dockerfile 的编写。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"　　需要注意的是，上面的内容是 Dockerfile 的基本结构和写法，但是实际写 Dockerfile 时还需要注意一些其他的事项。例如，你需要根据需要调整命令的执行顺序，确保每个命令都能够正常执行。此外，你还需要注意每个命令的格式，确保命令能够正确识别。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"　　总之，写 Dockerfile 需要注意很多细节，需要结合实际情况来进行调整和优化。如果遇到问题，可以查阅相关文档或者询问更有经验的开发人员。"}]},{"type":"element","tag":"h2","props":{"id":"docker-间通信"},"children":[{"type":"text","value":"docker 间通信"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"bridge 网络通信，不建议，此处略。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在宿主机，"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"ifconfig"}]},{"type":"text","value":" 查看各个 docker 的 ip。直接在 docker A 上指定 服务器 ip 访问 docker B"}]},{"type":"element","tag":"h2","props":{"id":"dockerfile"},"children":[{"type":"text","value":"dockerfile"}]},{"type":"element","tag":"h3","props":{"id":"expose"},"children":[{"type":"text","value":"EXPOSE"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"功能为暴漏容器运行时的监听端口给外部，但是EXPOSE并不会使容器访问主机的端口"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"如果想使得容器与主机的端口有映射关系，必须在容器启动的时候加上 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"-p"}]},{"type":"text","value":" 参数"}]},{"type":"element","tag":"h3","props":{"id":"volume"},"children":[{"type":"text","value":"VOLUME"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"可实现挂载功能，容器告诉Docker在主机上创建一个目录(默认情况下是在/var/lib/docker),然后将其挂载到指定的路径。当删除使用该Volume的容器时,Volume本身不会受到影响,它可以一直存在下去。"}]},{"type":"element","tag":"code","props":{"code":"FROM centos\n#将该镜像的存储内容挂载到test文件夹下。这样即使删除了该镜像，再重新创建后，也不会影响数据\nVOLUME /test  \nCMD echo \"hello docker\"\n","language":"dockerfile","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"FROM centos\n#将该镜像的存储内容挂载到test文件夹下。这样即使删除了该镜像，再重新创建后，也不会影响数据\nVOLUME /test  \nCMD echo \"hello docker\""}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"sol"},"children":[{"type":"text","value":"sol"}]},{"type":"element","tag":"h3","props":{"id":"docker-会损失性能吗"},"children":[{"type":"text","value":"docker 会损失性能吗"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://dominoweb.draco.res.ibm.com/reports/rc25482.pdf","rel":["nofollow"]},"children":[{"type":"text","value":"不会"}]}]},{"type":"element","tag":"h3","props":{"id":"debian-源加入-阿里云-的镜像源-会抛出-certificate-verification-failed"},"children":[{"type":"text","value":"debian 源加入 阿里云 的镜像源 会抛出 Certificate verification failed"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Certificate verification failed: The certificate is NOT trusted. The certificate issuer is unknown. Could not handshake: Error in the certificate verification."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"todo"}]},{"type":"element","tag":"h3","props":{"id":"不同系统可能出现不同的问题"},"children":[{"type":"text","value":"不同系统可能出现不同的问题"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在一次 docker 编译 c++ 代码实践中，mac 平台出现 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Relocations in generic ELF (EM: 62)"}]},{"type":"text","value":" 异常，linux 平台可以正常编译"}]},{"type":"element","tag":"h3","props":{"id":"docker-源超时问题"},"children":[{"type":"text","value":"docker 源超时问题"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"加上"},{"type":"element","tag":"a","props":{"href":"./linux/sys_category#%E5%AE%98%E6%96%B9%E6%BA%90%E8%B6%85%E6%97%B6"},"children":[{"type":"text","value":"国内源"}]},{"type":"text","value":"，在 dockerfile 里导入"}]},{"type":"element","tag":"code","props":{"code":"RUN cp /etc/apt/sources.list /etc/apt/sources.list.bak\nCOPY source_aliyun /home\nRUN cat /home/source_aliyun >> /etc/apt/sources.list\nRUN apt-get update\n","language":"docker","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"RUN"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" cp /etc/apt/sources.list /etc/apt/sources.list.bak"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"COPY"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" source_aliyun /home"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"RUN"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" cat /home/source_aliyun >> /etc/apt/sources.list"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-0d5069"},"children":[{"type":"text","value":"RUN"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" apt-get update"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"如果加上国内源出现"},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"Certificate verification failed: The certificate is NOT trusted. The certificate issuer is unknown.  Could not handshake: Error in the certificate verification."}]},{"type":"text","value":" 可以尝试加上 "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"echo 'Acquire { https::Verify-Peer false }' >>/etc/apt/apt.conf.d/99synaptic"}]}]},{"type":"element","tag":"h3","props":{"id":"error-you-dont-have-enough-free-space-in-varcacheaptarchives"},"children":[{"type":"text","value":"Error: You don't have enough free space in /var/cache/apt/archives/"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://github.com/onyx-platform/onyx-starter/issues/5#issuecomment-276562225","rel":["nofollow"]},"children":[{"type":"text","value":"refer"}]},{"type":"text","value":", "},{"type":"element","tag":"a","props":{"href":"https://github.com/onyx-platform/onyx-starter/issues/5#issuecomment-736082622","rel":["nofollow"]},"children":[{"type":"text","value":"refer"}]}]},{"type":"element","tag":"code","props":{"code":"docker system prune\n","language":"shell","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-46a4b2"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"system"}]},{"type":"element","tag":"span","props":{"class":"ct-3663db"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-0d6a80"},"children":[{"type":"text","value":"prune"}]}]}]}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"refer"},"children":[{"type":"text","value":"refer"}]},{"type":"element","tag":"list","props":{},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://yeasy.gitbook.io/docker_practice/","rel":["nofollow"]},"children":[{"type":"text","value":"Docker 从入门到实践"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://yeasy.gitbook.io/docker_practice/image/multistage-builds","rel":["nofollow"]},"children":[{"type":"text","value":"Dockerfile 多阶段构建"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://docs.docker.com/build/building/multi-stage/","rel":["nofollow"]},"children":[{"type":"text","value":"Multi-stage builds"}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-1343a9{color:#6E7781}\n.ct-0d5069{color:#CF222E}\n.ct-cd20f1{color:#0550AE}\n.ct-0d6a80{color:#0A3069}\n.ct-3663db{color:#24292F}\n.ct-46a4b2{color:#953800}\n.dark .ct-46a4b2{color:#FFA657}\n.dark .ct-3663db{color:#C9D1D9}\n.dark .ct-0d6a80{color:#A5D6FF}\n.dark .ct-cd20f1{color:#79C0FF}\n.dark .ct-0d5069{color:#FF7B72}\n.dark .ct-1343a9{color:#8B949E}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"install","depth":2,"text":"install","children":[{"id":"ubuntu","depth":3,"text":"ubuntu"},{"id":"debian","depth":3,"text":"debian"}]},{"id":"build","depth":2,"text":"build"},{"id":"run","depth":2,"text":"run"},{"id":"exec","depth":2,"text":"exec"},{"id":"save","depth":2,"text":"save"},{"id":"multi-stage","depth":2,"text":"multi-stage","children":[{"id":"参数传递","depth":3,"text":"参数传递"},{"id":"指定阶段","depth":3,"text":"指定阶段"},{"id":"阶段内引用","depth":3,"text":"阶段内引用"}]},{"id":"check-docker","depth":2,"text":"check docker"},{"id":"cp","depth":2,"text":"cp","children":[{"id":"dockerfile-内互相拷贝","depth":3,"text":"dockerfile 内互相拷贝"},{"id":"一个docker里的文件迁移到另一个docker","depth":3,"text":"一个docker里的文件迁移到另一个docker"}]},{"id":"第一个-docker","depth":2,"text":"第一个 docker"},{"id":"docker-间通信","depth":2,"text":"docker 间通信"},{"id":"dockerfile","depth":2,"text":"dockerfile","children":[{"id":"expose","depth":3,"text":"EXPOSE"},{"id":"volume","depth":3,"text":"VOLUME"}]},{"id":"sol","depth":2,"text":"sol","children":[{"id":"docker-会损失性能吗","depth":3,"text":"docker 会损失性能吗"},{"id":"debian-源加入-阿里云-的镜像源-会抛出-certificate-verification-failed","depth":3,"text":"debian 源加入 阿里云 的镜像源 会抛出 Certificate verification failed"},{"id":"不同系统可能出现不同的问题","depth":3,"text":"不同系统可能出现不同的问题"},{"id":"docker-源超时问题","depth":3,"text":"docker 源超时问题"},{"id":"error-you-dont-have-enough-free-space-in-varcacheaptarchives","depth":3,"text":"Error: You don't have enough free space in /var/cache/apt/archives/"}]},{"id":"refer","depth":2,"text":"refer"}]}},"_type":"markdown","_id":"content:5.notes:docker.md","_source":"content","_file":"5.notes/docker.md","_extension":"md"}