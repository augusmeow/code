{"_path":"/notes/makefile","_dir":"notes","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Makefile","description":"","icon":"flat-color-icons:make-decision","body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"beginner"},"children":[{"type":"text","value":"beginner"}]},{"type":"element","tag":"h2","props":{"id":"higher"},"children":[{"type":"text","value":"higher"}]},{"type":"element","tag":"h3","props":{"id":"使用-makefilein-和-configure"},"children":[{"type":"text","value":"使用 Makefile.in 和 configure"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Makefile.in 是一个模板文件，它指定了如何生成最终的 Makefile。它通常由项目的开发者提供，并且是一个文本文件。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Makefile.in 中可以包含各种指令，用来定义编译项目时所需的变量和规则。例如，下面是一个简单的 Makefile.in 示例："}]},{"type":"element","tag":"code","props":{"code":"# define some variables\nCC = gcc\nCFLAGS = -g -O2\n\n# define a target to build the executable\nmyapp: myapp.o\n        $(CC) $(CFLAGS) -o myapp myapp.o\n\n# define a target to clean up the project\nclean:\n        rm -f myapp myapp.o\n","filename":"Makefile.in","language":"makefile","meta":"[Makefile.in]"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1bf317"},"children":[{"type":"text","value":"# define some variables"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":"CC = gcc"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":"CFLAGS = -g -O2"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1bf317"},"children":[{"type":"text","value":"# define a target to build the executable"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-186a68"},"children":[{"type":"text","value":"myapp"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":": myapp.o"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"$("}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":"CC"}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"$("}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":"CFLAGS"}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" -o myapp myapp.o"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1bf317"},"children":[{"type":"text","value":"# define a target to clean up the project"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-186a68"},"children":[{"type":"text","value":"clean"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":":"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":"        rm -f myapp myapp.o"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"要生成最终的 Makefile，需要使用 configure 工具。configure 工具是一个 "},{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"shell"}]},{"type":"text","value":" 脚本，它的作用是根据系统环境和项目的特定要求来生成 Makefile。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"要编写一个 configure 脚本，需要了解 "},{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"shell"}]},{"type":"text","value":" 脚本语言，并且需要了解项目的特定环境和需求。一个简单的 configure 脚本示例如下所示："}]},{"type":"element","tag":"code","props":{"code":"#!/bin/bash\n\n# check for the required compiler\nif ! which gcc > /dev/null; then\n  echo \"Error: GCC is not installed\"\n  exit 1\nfi\n\n# check for the required libraries\nif ! pkg-config --exists libfoo; then\n  echo \"Error: libfoo is not installed\"\n  exit 1\nfi\n\n# create the Makefile\necho \"CC = gcc\" > Makefile\necho \"CFLAGS = -g -O2\" >> Makefile\necho \"\" >> Makefile\necho \"myapp: myapp.o\" >> Makefile\necho -e \"\\t\\$(CC) \\$(CFLAGS) -o myapp myapp.o\" >> Makefile\necho \"\" >> Makefile\necho \"clean:\" >> Makefile\necho -e \"\\trm -f myapp myapp.o\" >> Makefile\n","filename":"configure","language":"shell","meta":"[configure]"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1bf317"},"children":[{"type":"text","value":"#!/bin/bash"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1bf317"},"children":[{"type":"text","value":"# check for the required compiler"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":"!"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"which"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"gcc"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":">"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"/dev/null"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":"; "}]},{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":"then"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"\"Error: GCC is not installed\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"exit"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"1"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":"fi"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1bf317"},"children":[{"type":"text","value":"# check for the required libraries"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":"!"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-76d81c"},"children":[{"type":"text","value":"pkg-config"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"--exists"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"libfoo"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":"; "}]},{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":"then"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"\"Error: libfoo is not installed\""}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"exit"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"1"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":"fi"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-1bf317"},"children":[{"type":"text","value":"# create the Makefile"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"\"CC = gcc\""}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":">"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"Makefile"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"\"CFLAGS = -g -O2\""}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":">>"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"Makefile"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"\"\""}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":">>"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"Makefile"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"\"myapp: myapp.o\""}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":">>"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"Makefile"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"-e"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"\"\\t"}]},{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"\\$"}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"(CC) "}]},{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"\\$"}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"(CFLAGS) -o myapp myapp.o\""}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":">>"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"Makefile"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"\"\""}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":">>"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"Makefile"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"\"clean:\""}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":">>"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"Makefile"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"echo"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-27f5a6"},"children":[{"type":"text","value":"-e"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"\"\\trm -f myapp myapp.o\""}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3e2138"},"children":[{"type":"text","value":">>"}]},{"type":"element","tag":"span","props":{"class":"ct-67b8d0"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3be1aa"},"children":[{"type":"text","value":"Makefile"}]}]}]}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-76d81c{color:#953800}\n.ct-27f5a6{color:#0550AE}\n.ct-3e2138{color:#CF222E}\n.ct-3be1aa{color:#0A3069}\n.ct-186a68{color:#8250DF}\n.ct-67b8d0{color:#24292F}\n.ct-1bf317{color:#6E7781}\n.dark .ct-1bf317{color:#8B949E}\n.dark .ct-67b8d0{color:#C9D1D9}\n.dark .ct-186a68{color:#D2A8FF}\n.dark .ct-3be1aa{color:#A5D6FF}\n.dark .ct-3e2138{color:#FF7B72}\n.dark .ct-27f5a6{color:#79C0FF}\n.dark .ct-76d81c{color:#FFA657}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"beginner","depth":2,"text":"beginner"},{"id":"higher","depth":2,"text":"higher","children":[{"id":"使用-makefilein-和-configure","depth":3,"text":"使用 Makefile.in 和 configure"}]}]}},"_type":"markdown","_id":"content:5.notes:Makefile.md","_source":"content","_file":"5.notes/Makefile.md","_extension":"md"}