{"_path":"/cpp/lib/reactor","_dir":"lib","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Reactor","description":"","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"reactor"},"children":[{"type":"text","value":"Reactor"}]},{"type":"element","tag":"h2","props":{"id":"sample"},"children":[{"type":"text","value":"sample"}]},{"type":"element","tag":"code","props":{"code":"#include <iostream>\n#include <vector>\n#include <unordered_map>\n#include <functional>\n\nclass Reactor\n{\npublic:\n    Reactor() = default;\n    ~Reactor() = default;\n\n    // 注册事件处理函数\n    void register_handler(int event, std::function<void(int)> handler)\n    {\n        m_handlers[event] = handler;\n    }\n\n    // 分发事件\n    void dispatch(int event, int fd)\n    {\n        auto it = m_handlers.find(event);\n        if (it != m_handlers.end())\n            it->second(fd);\n    }\n\nprivate:\n    // 事件处理函数列表\n    std::unordered_map<int, std::function<void(int)>> m_handlers;\n};\n\nint main()\n{\n    // 创建Reactor对象\n    Reactor reactor;\n    // 注册事件处理函数\n    reactor.register_handler(1, [](int fd) { \n        std::cout << \"Event 1 triggered on fd \" << fd << std::endl; \n    });\n    reactor.register_handler(2, [](int fd) { \n        std::cout << \"Event 2 triggered on fd \" << fd << std::endl; \n    });\n\n    // 分发事件\n    reactor.dispatch(1, 5);\n    reactor.dispatch(2, 8);\n    reactor.dispatch(3, 9); // 无法处理的事件\n\n    return 0;\n}\n\n/* 输出结果:\nEvent 1 triggered on fd 5\nEvent 2 triggered on fd 8\n*/\n","language":"cpp","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"#include"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"<iostream>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"#include"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"<vector>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"#include"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"<unordered_map>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"#include"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"<functional>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"Reactor"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"public:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"Reactor"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"() "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"default"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"~Reactor"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"() "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"default"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-63bec8"},"children":[{"type":"text","value":"    // 注册事件处理函数"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"register_handler"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"event"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"::"}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"function"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":")> "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"handler"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        m_handlers[event] "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" handler;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-63bec8"},"children":[{"type":"text","value":"    // 分发事件"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"dispatch"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"event"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"fd"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"auto"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" it "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" m_handlers."}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"find"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"(event);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" (it "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"!="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" m_handlers."}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"end"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"())"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"            it->"}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"second"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"(fd);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"private:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-63bec8"},"children":[{"type":"text","value":"    // 事件处理函数列表"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"::unordered_map"}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"::function"}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<void"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":">>"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" m_handlers;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"};"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"main"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-63bec8"},"children":[{"type":"text","value":"    // 创建Reactor对象"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    Reactor reactor;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-63bec8"},"children":[{"type":"text","value":"    // 注册事件处理函数"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    reactor."}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"register_handler"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":", []("}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"fd"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":") { "}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"::cout "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"\"Event 1 triggered on fd \""}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" fd "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"::endl; "}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    });"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    reactor."}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"register_handler"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":", []("}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"fd"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":") { "}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"::cout "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"\"Event 2 triggered on fd \""}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" fd "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"::endl; "}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    });"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-63bec8"},"children":[{"type":"text","value":"    // 分发事件"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    reactor."}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"dispatch"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"5"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    reactor."}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"dispatch"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"8"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    reactor."}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"dispatch"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"3"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"9"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":");"}]},{"type":"element","tag":"span","props":{"class":"ct-63bec8"},"children":[{"type":"text","value":" // 无法处理的事件"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"}"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-63bec8"},"children":[{"type":"text","value":"/* 输出结果:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-63bec8"},"children":[{"type":"text","value":"Event 1 triggered on fd 5"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-63bec8"},"children":[{"type":"text","value":"Event 2 triggered on fd 8"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-63bec8"},"children":[{"type":"text","value":"*/"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"2"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"code","props":{"code":"#include <iostream>\n#include <vector>\n#include <map>\n#include <sys/epoll.h>\n#include <unistd.h>\n#include <fcntl.h>\n\nconst int MAX_EVENT_NUMBER = 1024;\n\nclass EventHandler;\n\nclass Reactor\n{\npublic:\n    Reactor()\n    {\n        epollfd = epoll_create1(0);\n    }\n    void registerHandler(int fd, EventHandler *eh)\n    {\n        struct epoll_event event;\n        event.data.ptr = eh;\n        event.events = eh->getEvents();\n        epoll_ctl(epollfd, EPOLL_CTL_ADD, fd, &event);\n        fd2eh[fd] = eh;\n    }\n\n    void removeHandler(int fd)\n    {\n        epoll_ctl(epollfd, EPOLL_CTL_DEL, fd, nullptr);\n        fd2eh.erase(fd);\n    }\n\n    void handleEvents()\n    {\n        int n = epoll_wait(epollfd, events, MAX_EVENT_NUMBER, -1);\n        for (int i = 0; i < n; i++)\n        {\n            EventHandler *eh = static_cast<EventHandler *>(events[i].data.ptr);\n            eh->handleEvents(events[i].events);\n        }\n    }\n\nprivate:\n    int epollfd;\n    std::map<int, EventHandler *> fd2eh;\n    struct epoll_event events[MAX_EVENT_NUMBER];\n};\n\nclass EventHandler\n{\npublic:\n    virtual int getFd() = 0;\n    virtual int getEvents() = 0;\n    virtual void handleEvents(int events) = 0;\n};\n\nclass IOEventHandler : public EventHandler\n{\npublic:\n    IOEventHandler(int fd)\n    {\n        this->fd = fd;\n    }\n    int getFd()\n    {\n        return fd;\n    }\n\n    int getEvents()\n    {\n        return events;\n    }\n\n    void handleEvents(int events)\n    {\n        if (events & EPOLLIN)\n        {\n            handleRead();\n        }\n        if (events & EPOLLOUT)\n        {\n            handleWrite();\n        }\n        if (events & EPOLLERR)\n        {\n            handleError();\n        }\n    }\n\nprivate:\n    int fd;\n    int events;\n    void handleRead()\n    {\n        std::cout << \"handleRead\" << std::endl;\n    }\n\n    void handleWrite()\n    {\n        std::cout << \"handleWrite\" << std::endl;\n    }\n\n    void handleError()\n    {\n        std::cout << \"handleError\" << std::endl;\n    }\n};\n\nint main()\n{\n    Reactor reactor;\n    int fd = open(\"test.txt\", O_RDWR | O_NONBLOCK);\n    IOEventHandler *ioeh = new IOEventHandler(fd);\n    reactor.registerHandler(fd, ioeh);\n    while (true)\n    {\n        reactor.handleEvents();\n    }\n\n    return 0;\n}\n","language":"cpp","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"#include"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"<iostream>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"#include"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"<vector>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"#include"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"<map>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"#include"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"<sys/epoll.h>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"#include"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"<unistd.h>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"#include"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"<fcntl.h>"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" MAX_EVENT_NUMBER "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"1024"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"EventHandler"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"Reactor"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"public:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"Reactor"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        epollfd "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"epoll_create1"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"registerHandler"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"fd"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"EventHandler"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"eh"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"struct"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"epoll_event"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" event;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        event.data.ptr "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" eh;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        event.events "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" eh->"}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"getEvents"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"();"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"epoll_ctl"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"(epollfd, EPOLL_CTL_ADD, fd, "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"&"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"event);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        fd2eh[fd] "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" eh;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"removeHandler"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"fd"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"epoll_ctl"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"(epollfd, EPOLL_CTL_DEL, fd, "}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"nullptr"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        fd2eh."}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"erase"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"(fd);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"handleEvents"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" n "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"epoll_wait"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"(epollfd, events, MAX_EVENT_NUMBER, "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" i "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"; i "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" n; i"}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"++"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"            EventHandler "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"eh "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"static_cast<"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"EventHandler "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"*>"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"(events[i].data.ptr);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"            eh->"}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"handleEvents"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"(events[i].events);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"private:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" epollfd;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"::map"}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":", EventHandler "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"*>"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" fd2eh;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"struct"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"epoll_event"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" events[MAX_EVENT_NUMBER];"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"};"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"EventHandler"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"public:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"virtual"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"getFd"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"() "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"virtual"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"getEvents"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"() "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"virtual"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"handleEvents"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"events"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"};"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"IOEventHandler"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" : "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"public"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"EventHandler"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"public:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"IOEventHandler"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"fd"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"->fd "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" fd;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"getFd"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" fd;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"getEvents"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" events;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"handleEvents"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"events"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" (events "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"&"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" EPOLLIN)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"handleRead"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"();"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" (events "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"&"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" EPOLLOUT)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"handleWrite"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"();"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" (events "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"&"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" EPOLLERR)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"handleError"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"();"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"private:"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" fd;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" events;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"handleRead"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"::cout "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"\"handleRead\""}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"::endl;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"handleWrite"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"::cout "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"\"handleWrite\""}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"::endl;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"void"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"handleError"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"::cout "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"\"handleError\""}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"<<"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3432cc"},"children":[{"type":"text","value":"std"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"::endl;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"};"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"main"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"()"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    Reactor reactor;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"int"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" fd "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"open"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-e7d396"},"children":[{"type":"text","value":"\"test.txt\""}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":", O_RDWR "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"|"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" O_NONBLOCK);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    IOEventHandler "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"ioeh "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"new"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"IOEventHandler"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"(fd);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    reactor."}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"registerHandler"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"(fd, ioeh);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"while"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"true"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"        reactor."}]},{"type":"element","tag":"span","props":{"class":"ct-361e99"},"children":[{"type":"text","value":"handleEvents"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"();"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-760ca9"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-401c64"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-fbdc11"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"这里没有考虑多线程情况，如果在多线程环境下使用该实现，需要对Reactor类进行线程同步处理。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"另外，这里的代码只是简单实现了Reactor模式的基本功能，实际项目中还可能需要支持的功能包括："}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"超时处理：epoll_wait函数可以指定超时时间，如果超时时间到了但没有事件发生，则返回0，可以通过这种方式实现超时处理。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"定时器处理：可以通过封装一个Timer类来实现定时器功能，定时器到期后可以触发相应的回调函数。"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"关闭处理：可以通过在Reactor中添加一个标志位来判断是否需要关闭，并在handleEvents函数中进行判断。"}]}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-401c64{color:#0550AE}\n.ct-63bec8{color:#6E7781}\n.ct-361e99{color:#8250DF}\n.ct-3432cc{color:#953800}\n.ct-e7d396{color:#0A3069}\n.ct-fbdc11{color:#24292F}\n.ct-760ca9{color:#CF222E}\n.dark .ct-760ca9{color:#FF7B72}\n.dark .ct-fbdc11{color:#C9D1D9}\n.dark .ct-e7d396{color:#A5D6FF}\n.dark .ct-3432cc{color:#FFA657}\n.dark .ct-361e99{color:#D2A8FF}\n.dark .ct-63bec8{color:#8B949E}\n.dark .ct-401c64{color:#79C0FF}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"sample","depth":2,"text":"sample"},{"id":"2","depth":2,"text":"2"}]}},"_type":"markdown","_id":"content:1.cpp:lib:reactor.md","_source":"content","_file":"1.cpp/lib/reactor.md","_extension":"md"}